(self["webpackJsonpclient-side"]=self["webpackJsonpclient-side"]||[]).push([[366],{9990:(e,t,s)=>{"use strict";s.d(t,{b:()=>g});var i=s(7433),n=s(649),a=s(4182),r=s(2803),o=(s(8764),s(7522),s(7887)),l=s(4258),d=s(7725),c=s(8129),h=s(2418),p=s(1295),u=s(6955),m=s(7878);function j(e,t){1&e&&(a["\u0275\u0275element"](0,"pep-field-title",12),a["\u0275\u0275pipe"](1,"translate")),2&e&&a["\u0275\u0275property"]("label",a["\u0275\u0275pipeBind1"](1,1,"Preview"))}let g=(()=>{class e{constructor(e,t,s,i,n,r,o,l){this.layoutService=e,this.dialog=t,this.translate=s,this.addonService=i,this.pluginService=n,this.routeParams=r,this.loaderService=o,this.cd=l,this.queriesOptions=[],this.chartsOptions=[],this.displayedColumns=["Name","Description"],this.hostEvents=new a.EventEmitter,this.layoutService.onResize$.subscribe(e=>{this.screenSize=e}),this.pluginService.addonUUID=this.routeParams.snapshot.params.addon_uuid}ngOnInit(){this.addonService.getAddonApiCall(this.pluginService.addonUUID,"api","queries").toPromise().then(e=>{e.forEach(e=>{this.queriesOptions.push({key:e.Key,value:e.Name})})}),this.addonService.getAddonApiCall("3d118baf-f576-4cdb-a81e-c2cc9af4d7ad","api","charts").toPromise().then(e=>{e.forEach(e=>{this.chartsOptions.push({key:e.Key,value:e.Name})})})}openDialog(){const e=this.translate.instant("Dialog_Body"),t=this.translate.instant("Dialog_Title"),s=new i.Hi({title:t,actionsType:"close",content:e});this.dialog.openDefaultDialog(s)}onChartSelected(e){e?this.addonService.getAddonApiCall("3d118baf-f576-4cdb-a81e-c2cc9af4d7ad","api",`charts?where=Key='${e}'`).toPromise().then(e=>{this.selectedChart=e[0],this.queryResult&&this.importChartFileAndExecute()}):(this.selectedChart=e,this.chartInstance=void 0)}onDataQuerySelected(e){e?this.addonService.postAddonApiCall(this.pluginService.addonUUID,"elastic",`execute?query_id=${e}`).toPromise().then(t=>{this.addonService.getAddonApiCall(this.pluginService.addonUUID,"api",`queries?where=Key='${e}'`).toPromise().then(e=>{this.selectedQuery=e[0],this.queryResult=t,this.selectedChart&&this.importChartFileAndExecute()})}):(this.queryResult=e,this.chartInstance=void 0)}onFileSelect(e){this.loaderService.show(),this.cd.detectChanges();let t=e.fileStr;console.log(t),this.ScriptURI=t,this.loaderService.hide()}importChartFileAndExecute(){System.import(this.selectedChart.ScriptURI).then(e=>{const t={label:this.selectedQuery.Name};this.loadSrcJSFiles(e.deps).then(()=>{const s=document.getElementById("previewArea");this.chartInstance=new e.default.default(s,t),this.chartInstance.data=this.queryResult,this.chartInstance.update(),this.loaderService.hide()}).catch(e=>{this.handleErrorDialog(this.translate.instant("FailedExecuteFile"))})}).catch(e=>{console.log(e),this.handleErrorDialog(this.translate.instant("FailedExecuteFile"))})}loadSrcJSFiles(e){let t=[];return e.forEach(e=>{t.push(new Promise(t=>{if(document.getElementById(e))t();else{let s=window.define;window.define=null;const i=document.createElement("script");i.src=e,i.id=e,i.onload=e=>{window.define=s,t()},i.onerror=e=>{this.handleErrorDialog(this.translate.instant("FailedLoadLibrary",{library:e.target.id}))},document.getElementsByTagName("head")[0].appendChild(i)}}))}),Promise.all(t)}handleErrorDialog(e){this.loaderService.hide(),this.pluginService.openDialog(this.translate.instant("Error"),e)}}return e.\u0275fac=function(t){return new(t||e)(a["\u0275\u0275directiveInject"](o.cd),a["\u0275\u0275directiveInject"](i.iu),a["\u0275\u0275directiveInject"](n.sK),a["\u0275\u0275directiveInject"](o.xD),a["\u0275\u0275directiveInject"](r.AddonService),a["\u0275\u0275directiveInject"](l.gz),a["\u0275\u0275directiveInject"](o.dV),a["\u0275\u0275directiveInject"](a.ChangeDetectorRef))},e.\u0275cmp=a["\u0275\u0275defineComponent"]({type:e,selectors:[["addon-module"]],viewQuery:function(e,t){if(1&e&&a["\u0275\u0275viewQuery"](r.PepperiTableComponent,5),2&e){let e;a["\u0275\u0275queryRefresh"](e=a["\u0275\u0275loadQuery"]())&&(t.table=e.first)}},inputs:{hostObject:"hostObject"},outputs:{hostEvents:"hostEvents"},features:[a["\u0275\u0275ProvidersFeature"]([n.X$])],decls:15,vars:14,consts:[[3,"ignoreResize"],["sideBar",""],[3,"key","label","xAlignment","options","valueChange"],["pep-top-area",""],[3,"title"],["header-start-content",""],["footer-start-content",""],["footer-end-content",""],["pep-main-area",""],[2,"width","60rem","margin-left","1rem","margin-top","1rem"],["class","body-xs title","class","header",3,"label",4,"ngIf"],["id","previewArea",3,"hidden"],[1,"header",3,"label"]],template:function(e,t){1&e&&(a["\u0275\u0275elementStart"](0,"pep-page-layout"),a["\u0275\u0275elementStart"](1,"pep-side-bar",0,1),a["\u0275\u0275elementStart"](3,"pep-select",2),a["\u0275\u0275listener"]("valueChange",function(e){return t.onChartSelected(e)}),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](4,"pep-select",2),a["\u0275\u0275listener"]("valueChange",function(e){return t.onDataQuerySelected(e)}),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementContainerStart"](5,3),a["\u0275\u0275elementStart"](6,"pep-top-bar",4),a["\u0275\u0275pipe"](7,"translate"),a["\u0275\u0275element"](8,"div",5),a["\u0275\u0275element"](9,"div",6),a["\u0275\u0275element"](10,"div",7),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementContainerEnd"](),a["\u0275\u0275elementContainerStart"](11,8),a["\u0275\u0275elementStart"](12,"div",9),a["\u0275\u0275template"](13,j,2,3,"pep-field-title",10),a["\u0275\u0275element"](14,"div",11),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementContainerEnd"](),a["\u0275\u0275elementEnd"]()),2&e&&(a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ignoreResize",!0),a["\u0275\u0275advance"](2),a["\u0275\u0275property"]("key","chartSelect")("label","Select a chart")("xAlignment","left")("options",t.chartsOptions),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("key","querySelect")("label","Select a data query")("xAlignment","left")("options",t.queriesOptions),a["\u0275\u0275advance"](2),a["\u0275\u0275property"]("title",a["\u0275\u0275pipeBind1"](7,12,"DataVisualization")),a["\u0275\u0275advance"](7),a["\u0275\u0275property"]("ngIf",t.chartInstance),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("hidden",!t.chartInstance))},directives:[d.O,c.i,h.t,p.K,u.NgIf,m.D],pipes:[n.X$],styles:["#previewArea[_ngcontent-%COMP%]{box-shadow:0 .5rem 1rem 0 hsla(0,0%,10%,.08);box-shadow:var(--pep-shadow-md-offset,0 .5rem 1rem 0) hsla(var(--pep-color-system-primary-h,0),var(--pep-color-system-primary-s,0%),var(--pep-color-system-primary-l,10%),.08);padding:1rem;border-radius:var(--pep-border-radius-lg)}  .pep-side-bar-container{height:inherit!important}"]}),e})()},8223:(e,t,s)=>{"use strict";s.d(t,{p:()=>C,$:()=>b});var i=s(2797),n=s(5471),a=s(6955),r=s(2693),o=s(649),l=s(1647),d=s(7878),c=s(2935),h=s(7433),p=s(7887),u=s(2418),m=s(7725),j=s(8129),g=s(1295),v=s(2437),f=s(4759),y=s(4182);function C(e,t,s){const i=t.getAssetsTranslationsPath(),n=t.getAssetsTranslationsSuffix(),a=s.getAddonStaticFolder();return new l.z(e,[{prefix:a.length>0?a+i:i,suffix:n},{prefix:a.length>0?a+"assets/i18n/":"/assets/i18n/",suffix:".json"}])}let b=(()=>{class e{constructor(e){let t="en";e.setDefaultLang(t),t=e.getBrowserLang().split("-")[0],location.href.indexOf("userLang=en")>-1&&(t="en"),e.use(t).subscribe(e=>{})}}return e.\u0275fac=function(t){return new(t||e)(y["\u0275\u0275inject"](o.sK))},e.\u0275mod=y["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=y["\u0275\u0275defineInjector"]({providers:[n.a,r.eN,o.gM,p.Td,p.xD,p.iM,p.qH,h.iu],imports:[[a.CommonModule,m.Z,j.t,r.JF,c.Is,i.QW,d.a,f.J,o.aw.forChild({loader:{provide:o.Zw,useFactory:C,deps:[r.eN,p.iM,p.xD]},isolate:!1}),u.A,g.j,v.qF]]}),e})()},5471:(e,t,s)=>{"use strict";s.d(t,{a:()=>d});var i=s(4762),n=s(911),a=s(5107),r=s(7433),o=s(4182),l=s(7887);let d=(()=>{class e{constructor(e,t,s,i){this.session=e,this.pepperiDataConverter=t,this.pepHttp=s,this.dialogService=i,this.accessToken="",this.papiBaseURL="",this.queries=[];const a=this.session.getIdpToken();this.parsedToken=(0,n.Z)(a),this.papiBaseURL=this.parsedToken["pepperi.baseurl"]}get papiClient(){return new a.PapiClient({baseURL:this.papiBaseURL,token:this.session.getIdpToken(),addonUUID:this.addonUUID,suppressLogging:!0})}ngOnInit(){}get(e){return(0,i.mG)(this,void 0,void 0,function*(){return yield this.papiClient.get(e)})}post(e,t){return(0,i.mG)(this,void 0,void 0,function*(){return yield this.papiClient.post(e,t)})}pepGet(e){return this.pepHttp.getPapiApiCall(e)}pepPost(e,t){return this.pepHttp.postPapiApiCall(e,t)}openDialog(e,t,s){const i={title:"OK",className:"",callback:s},n=this.dialogService.getDialogConfig({disableClose:!0,panelClass:"pepperi-standalone"},"inline"),a=new r.Hi({title:e,content:t,actionButtons:[i],actionsType:"custom",showClose:!1});this.dialogService.openDefaultDialog(a,n)}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275inject"](l.WF),o["\u0275\u0275inject"](l._1),o["\u0275\u0275inject"](l.Td),o["\u0275\u0275inject"](r.iu))},e.\u0275prov=o["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},2803:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AddonComponent:()=>i.b,AddonService:()=>n.a,AddonModule:()=>a.$,createTranslateLoader:()=>a.p,PepperiTableComponent:()=>r.D});var i=s(9990),n=s(5471),a=s(8223),r=s(1777)},1777:(e,t,s)=>{"use strict";s.d(t,{D:()=>o});var i=s(4182),n=s(7887),a=s(2437),r=s(649);let o=(()=>{class e{constructor(e,t){this.translate=e,this.dataConvertorService=t,this.dataSource=null,this.displayedColumns=null,this.customizeTable=null,this.listChanged=new i.EventEmitter,this.sortingChanged=new i.EventEmitter,this.fieldClicked=new i.EventEmitter,this.selectedItemsChanged=new i.EventEmitter}ngOnInit(){}ngOnChanges(e){var t;(null===(t=null==e?void 0:e.dataSource)||void 0===t?void 0:t.currentValue)&&this.initPepList(this.dataSource,this.displayedColumns,this.customizeTable)}initPepList(e,t=null,s=null){if(this.customList&&e){const i=new Array;e.forEach(e=>i.push(this.convertObjectToPepRowData(e,t,s)));const n=this.dataConvertorService.getUiControl(i[0]),a=this.dataConvertorService.convertListData(i);this.customList.initListData(n,a.length,a)}}convertObjectToPepRowData(e,t=null,s=null){const i=new n.n1;return i.Fields=[],(t||Object.keys(e)).forEach(t=>i.Fields.push(this.initDataRowField(e,t,s))),i}initDataRowField(e,t,s=null){const i={ApiName:t,Title:this.translate.instant(t),XAlignment:1,FormattedValue:e[t]?e[t].toString():"",Value:e[t]?e[t].toString():"",ColumnWidth:10,AdditionalValue:"",OptionalValues:[],FieldType:n.t9.TextBox};return s?s(e,t,i):i}getSelectedItemsData(){return this.customList.getSelectedItemsData()}getItemDataByID(e){return this.customList.getItemDataByID(e)}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](r.sK),i["\u0275\u0275directiveInject"](n._1))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["pep-table"]],viewQuery:function(e,t){if(1&e&&i["\u0275\u0275viewQuery"](a.wk,5),2&e){let e;i["\u0275\u0275queryRefresh"](e=i["\u0275\u0275loadQuery"]())&&(t.customList=e.first)}},inputs:{dataSource:"dataSource",displayedColumns:"displayedColumns",customizeTable:"customizeTable"},outputs:{listChanged:"listChanged",sortingChanged:"sortingChanged",fieldClicked:"fieldClicked",selectedItemsChanged:"selectedItemsChanged"},features:[i["\u0275\u0275NgOnChangesFeature"]],decls:3,vars:6,consts:[[1,"list-container"],["listContainer",""],[3,"firstFieldAsLink","isReport","supportSorting","supportResizing","selectionTypeForActions","noDataFoundMsg","listChange","sortingChange","fieldClick","selectedItemsChange"]],template:function(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div",0,1),i["\u0275\u0275elementStart"](2,"pep-list",2),i["\u0275\u0275listener"]("listChange",function(e){return t.listChanged.emit(e)})("sortingChange",function(e){return t.sortingChanged.emit(e)})("fieldClick",function(e){return t.fieldClicked.emit(e)})("selectedItemsChange",function(e){return t.selectedItemsChanged.emit(e)}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e&&(i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("firstFieldAsLink",!1)("isReport",!0)("supportSorting",!1)("supportResizing",!1)("selectionTypeForActions","single")("noDataFoundMsg","No data"))},directives:[a.wk],encapsulation:2}),e})()},6700:(e,t,s)=>{var i={"./af":776,"./af.js":776,"./ar":7634,"./ar-dz":2758,"./ar-dz.js":2758,"./ar-kw":3472,"./ar-kw.js":3472,"./ar-ly":9602,"./ar-ly.js":9602,"./ar-ma":2500,"./ar-ma.js":2500,"./ar-sa":6909,"./ar-sa.js":6909,"./ar-tn":2735,"./ar-tn.js":2735,"./ar.js":7634,"./az":7798,"./az.js":7798,"./be":9949,"./be.js":9949,"./bg":4590,"./bg.js":4590,"./bm":5938,"./bm.js":5938,"./bn":595,"./bn-bd":1942,"./bn-bd.js":1942,"./bn.js":595,"./bo":4756,"./bo.js":4756,"./br":7277,"./br.js":7277,"./bs":4166,"./bs.js":4166,"./ca":3943,"./ca.js":3943,"./cs":3474,"./cs.js":3474,"./cv":2218,"./cv.js":2218,"./cy":1061,"./cy.js":1061,"./da":2743,"./da.js":2743,"./de":1899,"./de-at":8580,"./de-at.js":8580,"./de-ch":3264,"./de-ch.js":3264,"./de.js":1899,"./dv":8784,"./dv.js":8784,"./el":4654,"./el.js":4654,"./en-au":6277,"./en-au.js":6277,"./en-ca":6896,"./en-ca.js":6896,"./en-gb":1609,"./en-gb.js":1609,"./en-ie":4557,"./en-ie.js":4557,"./en-il":5836,"./en-il.js":5836,"./en-in":262,"./en-in.js":262,"./en-nz":3586,"./en-nz.js":3586,"./en-sg":8965,"./en-sg.js":8965,"./eo":2777,"./eo.js":2777,"./es":3357,"./es-do":3128,"./es-do.js":3128,"./es-mx":9179,"./es-mx.js":9179,"./es-us":3256,"./es-us.js":3256,"./es.js":3357,"./et":2654,"./et.js":2654,"./eu":7287,"./eu.js":7287,"./fa":3875,"./fa.js":3875,"./fi":3431,"./fi.js":3431,"./fil":9606,"./fil.js":9606,"./fo":1781,"./fo.js":1781,"./fr":1717,"./fr-ca":1539,"./fr-ca.js":1539,"./fr-ch":9847,"./fr-ch.js":9847,"./fr.js":1717,"./fy":2250,"./fy.js":2250,"./ga":7665,"./ga.js":7665,"./gd":5214,"./gd.js":5214,"./gl":6154,"./gl.js":6154,"./gom-deva":8222,"./gom-deva.js":8222,"./gom-latn":8518,"./gom-latn.js":8518,"./gu":9221,"./gu.js":9221,"./he":4743,"./he.js":4743,"./hi":7339,"./hi.js":7339,"./hr":3224,"./hr.js":3224,"./hu":856,"./hu.js":856,"./hy-am":6855,"./hy-am.js":6855,"./id":2190,"./id.js":2190,"./is":3887,"./is.js":3887,"./it":9270,"./it-ch":5890,"./it-ch.js":5890,"./it.js":9270,"./ja":6595,"./ja.js":6595,"./jv":3081,"./jv.js":3081,"./ka":7477,"./ka.js":7477,"./kk":3978,"./kk.js":3978,"./km":9205,"./km.js":9205,"./kn":25,"./kn.js":25,"./ko":427,"./ko.js":427,"./ku":9089,"./ku.js":9089,"./ky":9314,"./ky.js":9314,"./lb":3136,"./lb.js":3136,"./lo":9115,"./lo.js":9115,"./lt":7087,"./lt.js":7087,"./lv":5683,"./lv.js":5683,"./me":9454,"./me.js":9454,"./mi":5507,"./mi.js":5507,"./mk":8466,"./mk.js":8466,"./ml":2933,"./ml.js":2933,"./mn":9477,"./mn.js":9477,"./mr":3597,"./mr.js":3597,"./ms":5529,"./ms-my":9965,"./ms-my.js":9965,"./ms.js":5529,"./mt":259,"./mt.js":259,"./my":8061,"./my.js":8061,"./nb":2618,"./nb.js":2618,"./ne":8452,"./ne.js":8452,"./nl":1885,"./nl-be":413,"./nl-be.js":413,"./nl.js":1885,"./nn":106,"./nn.js":106,"./oc-lnc":1763,"./oc-lnc.js":1763,"./pa-in":702,"./pa-in.js":702,"./pl":1711,"./pl.js":1711,"./pt":594,"./pt-br":8238,"./pt-br.js":8238,"./pt.js":594,"./ro":4681,"./ro.js":4681,"./ru":6201,"./ru.js":6201,"./sd":2912,"./sd.js":2912,"./se":6002,"./se.js":6002,"./si":7942,"./si.js":7942,"./sk":5577,"./sk.js":5577,"./sl":1775,"./sl.js":1775,"./sq":6823,"./sq.js":6823,"./sr":6869,"./sr-cyrl":3848,"./sr-cyrl.js":3848,"./sr.js":6869,"./ss":6173,"./ss.js":6173,"./sv":5788,"./sv.js":5788,"./sw":7626,"./sw.js":7626,"./ta":2678,"./ta.js":2678,"./te":6086,"./te.js":6086,"./tet":2447,"./tet.js":2447,"./tg":1335,"./tg.js":1335,"./th":8667,"./th.js":8667,"./tk":9222,"./tk.js":9222,"./tl-ph":9914,"./tl-ph.js":9914,"./tlh":1389,"./tlh.js":1389,"./tr":3578,"./tr.js":3578,"./tzl":6969,"./tzl.js":6969,"./tzm":6509,"./tzm-latn":690,"./tzm-latn.js":690,"./tzm.js":6509,"./ug-cn":55,"./ug-cn.js":55,"./uk":2452,"./uk.js":2452,"./ur":1151,"./ur.js":1151,"./uz":1555,"./uz-latn":6547,"./uz-latn.js":6547,"./uz.js":1555,"./vi":6541,"./vi.js":6541,"./x-pseudo":2401,"./x-pseudo.js":2401,"./yo":2341,"./yo.js":2341,"./zh-cn":619,"./zh-cn.js":619,"./zh-hk":7058,"./zh-hk.js":7058,"./zh-mo":9141,"./zh-mo.js":9141,"./zh-tw":2782,"./zh-tw.js":2782};function n(e){var t=a(e);return s(t)}function a(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=a,e.exports=n,n.id=6700}}]);